{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Create and Link Alerts",
    "aliasName": null,
    "tag": "",
    "description": "Creates and links an Alert",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "commandline",
        "userName",
        "technique",
        "processName",
        "MD5",
        "hostName",
        "sourceIP",
        "destinationIP",
        "sourceTool",
        "parentProcess",
        "eventTime",
        "parentProcessID",
        "processID",
        "parentCommandLine",
        "filePath",
        "eventName",
        "description",
        "epochTime",
        "comment",
        "sourceImage",
        "targetImage",
        "source",
        "processGUID",
        "scheduledTask",
        "service",
        "url",
        "bytestransferred",
        "bitstransferid",
        "sourceData",
        "registryKey",
        "registryKeyValue",
        "computerName",
        "alertName",
        "decodedCommandLine",
        "mitre_tech_id",
        "alertType",
        "huntIRI"
    ],
    "synchronous": false,
    "lastModifyDate": 1639986939,
    "collection": "\/api\/3\/workflow_collections\/234e09da-6930-4fd2-ada5-43bfc65f59f5",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c8ea5a26-54d4-4d2f-be68-7276fcafc3a7",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Comment to Hunt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}",
                    "people": [],
                    "content": "<p>{{vars.input.params.comment}}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "c4fb3e0e-8a19-4efc-a2c5-5603ad17bd29",
            "id": 5587
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "url": "{{vars.input.params.url or None}}",
                    "name": "{% if vars.input.params.alertName%}{{vars.input.params.alertName}}{% else %}MITRE-{{vars.input.params.technique}} Execution of {{vars.input.params.processName}}{% endif %}",
                    "type": "{{vars.input.params.alertType}}",
                    "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}",
                    "state": {
                        "id": 220,
                        "@id": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "New",
                        "listName": "\/api\/3\/picklist_names\/2f9ed741-25fe-475a-9f12-64336288eebf",
                        "itemValue": "New",
                        "orderIndex": 0
                    },
                    "source": "{{vars.input.params.source or None}}",
                    "status": {
                        "id": 120,
                        "@id": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Open",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Open",
                        "orderIndex": 0
                    },
                    "fileHash": "{{vars.input.params.MD5 or None}}",
                    "filePath": "{{vars.input.params.filePath or None}}",
                    "services": "{{vars.input.params.service or None}}",
                    "severity": {
                        "id": 81,
                        "@id": "\/api\/3\/picklists\/40187287-89fc-4e9c-b717-e9443d57eedb",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#DE7A13",
                        "display": "High",
                        "listName": "\/api\/3\/picklist_names\/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                        "itemValue": "High",
                        "orderIndex": 3
                    },
                    "sourceIp": "{{vars.input.params.sourceIP or None}}",
                    "userName": "{{vars.input.params.userName or None}}",
                    "__replace": "true",
                    "epochTime": "{{vars.input.params.epochTime}}",
                    "eventTime": "{{vars.input.params.eventTime}}",
                    "processId": "{{vars.input.params.processID or None}}",
                    "sourceTool": "{{vars.input.params.sourceTool or None}}",
                    "sourcedata": "{{vars.input.params.sourceData | toJSON}}",
                    "commandLine": "{{vars.input.params.commandline or None}}",
                    "description": "<p>{{vars.input.params.description}}<\/p>",
                    "processGuid": "{{vars.input.params.processGUID or None}}",
                    "processName": "{{vars.input.params.processName or None}}",
                    "registryKey": "{{vars.input.params.registryKey or None}}",
                    "targetAsset": "{{vars.input.params.hostName or None}}",
                    "ackSlaStatus": {
                        "id": 289,
                        "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "Awaiting Action",
                        "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                        "itemValue": "Awaiting Action",
                        "orderIndex": 2
                    },
                    "computerName": "{{vars.input.params.computerName or None}}",
                    "closureReason": {
                        "id": 250,
                        "@id": "\/api\/3\/picklists\/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                        "icon": null,
                        "uuid": "8590c81e-3307-4645-97f5-c3e1bec4e05a",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Tasks Completed",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                        "itemValue": "Tasks Completed",
                        "orderIndex": 0
                    },
                    "destinationIp": "{{vars.input.params.destinationIP or None}}",
                    "mitreattackid": "{{vars.input.params['mitre_tech_id']}}",
                    "respSlaStatus": {
                        "id": 289,
                        "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "Awaiting Action",
                        "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                        "itemValue": "Awaiting Action",
                        "orderIndex": 2
                    },
                    "scheduledTask": "{{vars.input.params.scheduledTask or None}}",
                    "sourceProcess": "{{vars.input.params.sourceImage or None}}",
                    "targetProcess": "{{vars.input.params.targetImage or None}}",
                    "mitreTechnique": "{{vars.input.params.technique}}",
                    "priorityWeight": 1,
                    "bytesTransferred": "{{vars.input.params.bytestransferred or None}}",
                    "parentProcessPid": "{{vars.input.params.parentProcessID or None}}",
                    "registryKeyValue": "{{vars.input.params.registryKeyValue or None}}",
                    "parentProcessName": "{{vars.input.params.parentProcess or None}}",
                    "decodedCommandLine": "{{vars.input.params.decodedCommandLine or None}}",
                    "escalatedtoincident": {
                        "id": 32,
                        "@id": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "No",
                        "listName": "\/api\/3\/picklist_names\/e131cc54-9ae4-43c9-b830-af6e331fe024",
                        "itemValue": "No",
                        "orderIndex": 1
                    },
                    "alertRemainingAckSLA": 0,
                    "parentProcessCmdLine": "{{vars.input.params.parentCommandLine or None}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/alerts",
                "__recommend": [],
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "05c316a8-94a9-4a4b-9632-ef88482a48e7",
            "id": 5588
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Step Output",
            "description": null,
            "arguments": {
                "alert_data": "{{vars.steps.Create_and_Link_Alert}}"
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "02ce226e-a971-4f5c-a61e-1f613cd00d23",
            "id": 5589
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "c8ea5a26-54d4-4d2f-be68-7276fcafc3a7",
            "id": 5590
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Alert -> Create and Link Comment to Hunt",
            "targetStep": "\/api\/3\/workflow_steps\/c4fb3e0e-8a19-4efc-a2c5-5603ad17bd29",
            "sourceStep": "\/api\/3\/workflow_steps\/05c316a8-94a9-4a4b-9632-ef88482a48e7",
            "label": null,
            "isExecuted": false,
            "uuid": "bf8b540e-e158-48d8-99b6-f6fbbe89edfc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Comment to Hunt -> Set Step Output",
            "targetStep": "\/api\/3\/workflow_steps\/02ce226e-a971-4f5c-a61e-1f613cd00d23",
            "sourceStep": "\/api\/3\/workflow_steps\/c4fb3e0e-8a19-4efc-a2c5-5603ad17bd29",
            "label": null,
            "isExecuted": false,
            "uuid": "4ce03d21-4dd5-497a-b7d7-e387ff48257d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Create and Link Alert",
            "targetStep": "\/api\/3\/workflow_steps\/05c316a8-94a9-4a4b-9632-ef88482a48e7",
            "sourceStep": "\/api\/3\/workflow_steps\/c8ea5a26-54d4-4d2f-be68-7276fcafc3a7",
            "label": null,
            "isExecuted": false,
            "uuid": "fa81ee07-4d95-4fdd-b2ab-4143f3ba98e4"
        }
    ],
    "priority": null,
    "uuid": "262cfb8f-948c-4d2f-b630-bcdb8739a737",
    "recordTags": [],
    "id": 1352,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1638960150,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1640012920,
    "owners": [],
    "isPrivate": false
}